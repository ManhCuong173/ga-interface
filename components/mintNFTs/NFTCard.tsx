import { useInscribeContext } from '@/context/InscribeContext'
import { NFT } from '@/types/nft'
import Image from 'next/image'
import { useCallback } from 'react'

type Props = {
    item: NFT
    isPick?: boolean
    picked?: boolean
    ableView?: boolean
    setNFT?: any
}

export const NFTCard = ({ item, isPick, ableView, setNFT}: Props) => {
    return (
        <>
            {isPick ? (
                <NFTPick item={item} />
            ) : (
                <>
                    <div
                        className={`relative border p-[3.5px] ${ableView? 'border-[#12B76A] cursor-pointer':'border-[#D4C79C]'} nft-card h-fit w-fit rounded-[10px]`}
                        onClick={() => {
                            if(ableView)
                                setNFT(item)
                        } 
                    }
                    >
                        <div className='sm:h-[150px] sm:w-[150px] w-full h-[145px] overflow-hidden rounded-lg'>
                            <Image
                                src={item.nft_link}
                                loader={() => item.nft_link}
                                width={0}
                                height={0}
                                sizes='100vw'
                                alt=''
                                className='h-full w-full object-cover'
                            />
                        </div>
                        {ableView && (
                            <div className='view-tag absolute right-3 top-3 flex w-fit  items-center gap-1 rounded-[4px] bg-white px-2 py-[2px]'>
                                <svg
                                    xmlns='http://www.w3.org/2000/svg'
                                    width='17'
                                    height='16'
                                    viewBox='0 0 17 16'
                                    fill='none'
                                >
                                    <path
                                        d='M2.22232 9.89442C2.00238 9.89488 1.78454 9.85059 1.58133 9.7641C1.37813 9.67761 1.19358 9.55064 1.03832 9.3905C0.882928 9.23046 0.759722 9.04052 0.675735 8.83153C0.591749 8.62254 0.548626 8.39859 0.548829 8.17247C0.549031 7.94635 0.592555 7.72248 0.676916 7.51365C0.761277 7.30481 0.884823 7.11511 1.0405 6.95536C1.19618 6.79562 1.38093 6.66896 1.58422 6.58262C1.78752 6.49627 2.00536 6.45194 2.22532 6.45215C2.44527 6.45236 2.66304 6.4971 2.86617 6.58383C3.06931 6.67056 3.25384 6.79757 3.40923 6.95761L4.45505 8.03274C4.49137 8.07028 4.51177 8.12109 4.51177 8.17405C4.51177 8.22701 4.49137 8.27781 4.45505 8.31536L3.40923 9.3905C3.25362 9.551 3.0686 9.67818 2.86487 9.76468C2.66114 9.85118 2.44274 9.89527 2.22232 9.89442ZM1.31323 9.10938C1.55473 9.35647 1.88159 9.49519 2.22232 9.49519C2.56304 9.49519 2.8899 9.35647 3.13141 9.10938L4.0405 8.1748L3.13141 7.23872C2.89011 6.99085 2.56292 6.85169 2.2218 6.85183C1.88069 6.85197 1.55361 6.9914 1.3125 7.23947C1.07139 7.48753 0.936019 7.8239 0.936156 8.17458C0.936292 8.52525 1.07193 8.86151 1.31323 9.10938Z'
                                        fill='#4E473F'
                                    />
                                    <path
                                        d='M6.40696 14.2056C6.07592 14.2053 5.75236 14.1042 5.4772 13.915C5.20204 13.7258 4.98763 13.4569 4.86107 13.1424C4.73451 12.828 4.70147 12.482 4.76615 12.1482C4.83082 11.8144 4.9903 11.5079 5.22442 11.2672L6.27024 10.1921C6.30676 10.1548 6.35618 10.1338 6.40769 10.1338C6.45921 10.1338 6.50862 10.1548 6.54515 10.1921L8.63678 12.3439C8.67302 12.3812 8.69338 12.4317 8.69338 12.4844C8.69338 12.5372 8.67302 12.5877 8.63678 12.625L7.59096 13.7016C7.4358 13.8619 7.25127 13.989 7.04804 14.0755C6.84481 14.162 6.62692 14.2062 6.40696 14.2056ZM6.40696 10.6168L5.49787 11.5514C5.25681 11.7992 5.12139 12.1354 5.12139 12.4859C5.12139 12.8365 5.25681 13.1726 5.49787 13.4205C5.74191 13.6626 6.06782 13.798 6.40696 13.798C6.74611 13.798 7.07202 13.6626 7.31606 13.4205L8.22515 12.4859L6.40696 10.6168Z'
                                        fill='#4E473F'
                                    />
                                    <path
                                        d='M6.4069 10.5255C6.35561 10.5255 6.30643 10.5045 6.27017 10.4672L4.17708 8.31543C4.14075 8.27788 4.12036 8.22708 4.12036 8.17412C4.12036 8.12116 4.14075 8.07036 4.17708 8.03281L6.27017 5.88254C6.3067 5.84519 6.35611 5.82422 6.40763 5.82422C6.45914 5.82422 6.50856 5.84519 6.54508 5.88254L8.63672 8.03281C8.67305 8.07036 8.69344 8.12116 8.69344 8.17412C8.69344 8.22708 8.67305 8.27788 8.63672 8.31543L6.54508 10.4672C6.52696 10.4859 6.50541 10.5006 6.48169 10.5106C6.45797 10.5206 6.43254 10.5257 6.4069 10.5255ZM4.58872 8.17487L6.4069 10.044L8.22508 8.17487L6.4069 6.30571L4.58872 8.17487Z'
                                        fill='#4E473F'
                                    />
                                    <path
                                        d='M8.49992 12.676C8.44862 12.676 8.39944 12.655 8.36319 12.6177L6.2701 10.4674C6.23377 10.4299 6.21338 10.3791 6.21338 10.3261C6.21338 10.2732 6.23377 10.2224 6.2701 10.1848L8.36319 8.03303C8.39946 7.99577 8.44864 7.97485 8.49992 7.97485C8.55119 7.97485 8.60037 7.99577 8.63665 8.03303L10.7297 10.1848C10.7661 10.2224 10.7865 10.2732 10.7865 10.3261C10.7865 10.3791 10.7661 10.4299 10.7297 10.4674L8.63665 12.6177C8.60039 12.655 8.55121 12.676 8.49992 12.676ZM6.68174 10.3254L8.49992 12.1945L10.3181 10.3254L8.49992 8.45621L6.68174 10.3254Z'
                                        fill='#4E473F'
                                    />
                                    <path
                                        d='M10.5931 14.2056C10.3731 14.2062 10.1552 14.162 9.95198 14.0755C9.74875 13.989 9.56422 13.8619 9.40906 13.7016L8.36324 12.625C8.327 12.5877 8.30664 12.5372 8.30664 12.4844C8.30664 12.4317 8.327 12.3812 8.36324 12.3439L10.4549 10.1921C10.4914 10.1548 10.5408 10.1338 10.5923 10.1338C10.6438 10.1338 10.6933 10.1548 10.7298 10.1921L11.7756 11.2672C12.0097 11.5079 12.1692 11.8144 12.2339 12.1482C12.2985 12.482 12.2655 12.828 12.139 13.1424C12.0124 13.4569 11.798 13.7258 11.5228 13.915C11.2477 14.1042 10.9241 14.2053 10.5931 14.2056ZM8.77487 12.4844L9.68397 13.419C9.928 13.6611 10.2539 13.7965 10.5931 13.7965C10.9322 13.7965 11.2581 13.6611 11.5021 13.419C11.7432 13.1711 11.8786 12.835 11.8786 12.4844C11.8786 12.1339 11.7432 11.7977 11.5021 11.5499L10.5931 10.6153L8.77487 12.4844Z'
                                        fill='#4E473F'
                                    />
                                    <path
                                        d='M6.40697 6.22198C6.35568 6.22195 6.30649 6.20097 6.27024 6.16366L5.22442 5.08404C4.91079 4.76131 4.73462 4.32378 4.73462 3.86759C4.73462 3.4114 4.91079 2.97387 5.22442 2.65114C5.54301 2.33791 5.96686 2.16309 6.4077 2.16309C6.84853 2.16309 7.27238 2.33791 7.59097 2.65114L8.63679 3.72628C8.67312 3.76383 8.69351 3.81463 8.69351 3.86759C8.69351 3.92055 8.67312 3.97135 8.63679 4.0089L6.54515 6.15918C6.52739 6.17864 6.50601 6.19423 6.48227 6.20502C6.45853 6.21581 6.43292 6.22158 6.40697 6.22198ZM6.40697 2.54946C6.15269 2.54951 5.90414 2.62706 5.69273 2.77231C5.48132 2.91757 5.31655 3.124 5.21925 3.36551C5.12195 3.60702 5.09649 3.87276 5.14608 4.12914C5.19568 4.38553 5.3181 4.62104 5.49788 4.80591L6.40697 5.74049L8.22515 3.87133L7.31606 2.93675C7.19702 2.81353 7.05536 2.71584 6.8993 2.64936C6.74324 2.58288 6.5759 2.54892 6.40697 2.54946Z'
                                        fill='#4E473F'
                                    />
                                    <path
                                        d='M8.50004 8.37387C8.44874 8.37384 8.39956 8.35286 8.36331 8.31555L6.27022 6.16377C6.23398 6.12648 6.21362 6.07594 6.21362 6.02322C6.21362 5.97051 6.23398 5.91995 6.27022 5.88266L8.36331 3.73836C8.39958 3.7011 8.44876 3.68018 8.50004 3.68018C8.55131 3.68018 8.60049 3.7011 8.63677 3.73836L10.7299 5.89014C10.7661 5.92743 10.7865 5.97798 10.7865 6.0307C10.7865 6.08341 10.7661 6.13397 10.7299 6.17126L8.63677 8.32303C8.59935 8.35761 8.55031 8.37585 8.50004 8.37387ZM6.68186 6.02322L8.50004 7.89238L10.3182 6.02322L8.50004 4.15406L6.68186 6.02322Z'
                                        fill='#4E473F'
                                    />
                                    <path
                                        d='M10.5932 10.5255C10.5675 10.5257 10.5421 10.5206 10.5184 10.5106C10.4947 10.5006 10.4731 10.4859 10.455 10.4672L8.36336 8.31543C8.32703 8.27788 8.30664 8.22708 8.30664 8.17412C8.30664 8.12116 8.32703 8.07036 8.36336 8.03281L10.455 5.88254C10.4915 5.84519 10.5409 5.82422 10.5925 5.82422C10.644 5.82422 10.6934 5.84519 10.7299 5.88254L12.823 8.03281C12.8593 8.07036 12.8797 8.12116 12.8797 8.17412C12.8797 8.22708 12.8593 8.27788 12.823 8.31543L10.7299 10.4672C10.6937 10.5045 10.6445 10.5255 10.5932 10.5255ZM8.775 8.17487L10.5932 10.044L12.4114 8.17487L10.5932 6.30571L8.775 8.17487Z'
                                        fill='#4E473F'
                                    />
                                    <path
                                        d='M10.5932 6.22213C10.5675 6.22231 10.5421 6.21725 10.5184 6.20723C10.4947 6.19722 10.4731 6.18246 10.455 6.16381L8.36336 4.01354C8.32703 3.97599 8.30664 3.92519 8.30664 3.87223C8.30664 3.81927 8.32703 3.76846 8.36336 3.73092L9.40918 2.65578C9.72777 2.34255 10.1516 2.16772 10.5925 2.16772C11.0333 2.16772 11.4571 2.34255 11.7757 2.65578C12.0894 2.9785 12.2655 3.41604 12.2655 3.87223C12.2655 4.32842 12.0894 4.76595 11.7757 5.08868L10.7299 6.16381C10.6937 6.20111 10.6445 6.22209 10.5932 6.22213ZM8.775 3.87148L10.5932 5.74064L11.5023 4.80606C11.7433 4.55817 11.8788 4.222 11.8788 3.87148C11.8788 3.52096 11.7433 3.18479 11.5023 2.9369C11.2582 2.69478 10.9323 2.55946 10.5932 2.55946C10.254 2.55946 9.92812 2.69478 9.68409 2.9369L8.775 3.87148Z'
                                        fill='#4E473F'
                                    />
                                    <path
                                        d='M14.7777 9.89464C14.5573 9.89549 14.3389 9.85139 14.1352 9.76489C13.9314 9.67839 13.7464 9.55121 13.5908 9.39071L12.545 8.31557C12.5087 8.27802 12.4883 8.22722 12.4883 8.17426C12.4883 8.1213 12.5087 8.0705 12.545 8.03295L13.5908 6.95782C13.7854 6.75737 14.025 6.60937 14.2886 6.52694C14.5521 6.4445 14.8313 6.43018 15.1015 6.48525C15.3717 6.54031 15.6245 6.66306 15.8375 6.8426C16.0505 7.02215 16.2171 7.25294 16.3225 7.51453C16.428 7.77612 16.469 8.06043 16.442 8.34223C16.415 8.62403 16.3208 8.89463 16.1677 9.13004C16.0147 9.36545 15.8075 9.55839 15.5645 9.69177C15.3215 9.82514 15.0503 9.89482 14.7748 9.89464H14.7777ZM13.8686 9.10959C14.0485 9.29428 14.2776 9.42 14.527 9.47086C14.7764 9.52172 15.0348 9.49545 15.2697 9.39535C15.5046 9.29525 15.7053 9.12581 15.8465 8.90847C15.9877 8.69113 16.0631 8.43563 16.0631 8.17426C16.0631 7.9129 15.9877 7.6574 15.8465 7.44006C15.7053 7.22272 15.5046 7.05328 15.2697 6.95318C15.0348 6.85308 14.7764 6.82681 14.527 6.87767C14.2776 6.92853 14.0485 7.05424 13.8686 7.23893L12.9595 8.17501L13.8686 9.10959Z'
                                        fill='#4E473F'
                                    />
                                </svg>
                                <span className='text-xs font-medium leading-[18px] tracking-[-0.38px] text-[#4E473F]'>
                                    View
                                </span>
                            </div>
                        )}
                    </div>
                </>
            )}
        </>
    )
}

const NFTPick = ({ item }: { item: NFT }) => {
    const { inscribeData, setInscribeData } = useInscribeContext()

    const handleSetPickNFT = (item: NFT) => {
        setInscribeData({
            type: 'PICK_NFT',
            nft: item,
        })
    }

    const handleCheckIsPickNFT = useCallback(() => {
        return inscribeData.pickedNfts.includes(item)
    }, [inscribeData.pickedNfts, item])

    return (
        <div
            onClick={() => {
                handleSetPickNFT(item)
            }}
            className={`nft-card relative h-fit w-fit cursor-pointer rounded-[10px] border p-[3.5px] hover:border-[#12B76A] ${handleCheckIsPickNFT() ? 'border-[#12B76A]':''} `}
        >
            <div className='sm:h-[150px] sm:w-[150px] w-full h-[145px] overflow-hidden rounded-lg'>
                <Image
                    src={item.nft_link}
                    loader={() => item.nft_link}
                    width={0}
                    height={0}
                    sizes='100vw'
                    alt=''
                    className='h-full w-full object-cover'
                />
            </div>

            <div className='absolute right-2 top-2'>
                {handleCheckIsPickNFT() ? (
                    <svg
                        xmlns='http://www.w3.org/2000/svg'
                        width='21'
                        height='20'
                        viewBox='0 0 21 20'
                        fill='none'
                    >
                        <circle cx='10.3335' cy='10' r='9.5' fill='#12B76A' stroke='#4E473F' />
                        <path
                            fill-rule='evenodd'
                            clip-rule='evenodd'
                            d='M14.6917 5.43132L8.12023 11.7733L6.3764 9.9102C6.05517 9.60733 5.55038 9.58897 5.18326 9.84596C4.82531 10.1121 4.72436 10.5802 4.94463 10.9565L7.00969 14.3157C7.2116 14.6277 7.56037 14.8205 7.95502 14.8205C8.33132 14.8205 8.68927 14.6277 8.89118 14.3157C9.22159 13.8843 15.5269 6.36748 15.5269 6.36748C16.3529 5.5231 15.3525 4.77968 14.6917 5.42214V5.43132Z'
                            fill='#F0F0F0'
                        />
                    </svg>
                ) : (
                    <svg
                        xmlns='http://www.w3.org/2000/svg'
                        width='20'
                        height='20'
                        viewBox='0 0 20 20'
                        fill='none'
                    >
                        <circle cx='10' cy='10' r='9.5' stroke='#4E473F' />
                    </svg>
                )}
            </div>
        </div>
    )
}
